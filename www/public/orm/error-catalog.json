{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "Better-Convex ORM Error Catalog",
  "description": "Common TypeScript errors and their solutions for Better-Convex ORM",
  "version": "1.0.0-m6",
  "lastUpdated": "2026-02-02",
  "errors": {
    "type_errors": {
      "null_instead_of_undefined": {
        "pattern": "Type 'null' is not assignable to type",
        "message": "Convex uses undefined for optional fields, not null",
        "example_wrong": "age: null",
        "example_correct": "age: undefined",
        "doc_url": "/docs/db/orm/schema#optional-fields",
        "severity": "error"
      },
      "nullable_field_type_error": {
        "pattern": "Type 'number | null' is not assignable",
        "message": "Column builders are nullable by default - use .notNull() for required fields",
        "example_wrong": "age: integer() | null",
        "example_correct": "age: integer() // Already nullable",
        "doc_url": "/docs/db/orm/schema#nullable-fields",
        "severity": "error"
      },
      "wrong_field_type": {
        "pattern": "Type 'string' is not assignable to type 'number'",
        "message": "Field type mismatch - check schema definition",
        "example_wrong": "age: '25'",
        "example_correct": "age: 25",
        "doc_url": "/docs/db/orm/type-safety#type-mismatch-in-filters",
        "severity": "error"
      },
      "nonexistent_field": {
        "pattern": "Property '...' does not exist on type",
        "message": "Field does not exist in schema - check spelling or schema definition",
        "example_wrong": "eq(users.nonExistent, 'value')",
        "example_correct": "eq(users.name, 'value')",
        "doc_url": "/docs/db/orm/type-safety#wrong-field-name",
        "severity": "error"
      },
      "missing_required_field": {
        "pattern": "Property '...' is missing in type",
        "message": "All required fields must be provided",
        "example_wrong": "{ name: 'Alice' }",
        "example_correct": "{ name: 'Alice', email: 'alice@example.com' }",
        "doc_url": "/docs/db/orm/type-safety#missing-required-fields",
        "severity": "error"
      },
      "wrong_relation_type": {
        "pattern": "Type '...' is not assignable to parameter of type 'TableRelation'",
        "message": "Relation configuration mismatch - check fields and references",
        "example_wrong": "fields: [posts.userId], references: [users.email]",
        "example_correct": "fields: [posts.userId], references: [users._id]",
        "doc_url": "/docs/db/orm/schema#defining-relations",
        "severity": "error"
      }
    },
    "runtime_errors": {
      "undefined_table": {
        "pattern": "Cannot read property 'findMany' of undefined",
        "message": "Table not found in database schema - check exports",
        "solution": "Ensure table is exported in schema and passed to db() setup",
        "doc_url": "/docs/db/orm/schema#exporting-schema",
        "severity": "error"
      },
      "missing_context": {
        "pattern": "ctx is undefined",
        "message": "QueryCtx or MutationCtx not provided to db()",
        "solution": "Pass ctx from query/mutation handler: db(ctx)",
        "doc_url": "/docs/db/orm/quickstart#step-3-use-in-queries",
        "severity": "error"
      },
      "relation_not_loaded": {
        "pattern": "Cannot read property '...' of undefined",
        "message": "Relation not loaded - use 'with' to include",
        "solution": "Add relation to 'with' clause: { with: { posts: true } }",
        "doc_url": "/docs/db/orm/queries#loading-relations",
        "severity": "error"
      },
      "invalid_cursor": {
        "pattern": "Invalid cursor format",
        "message": "Cursor must be string from previous page or null",
        "solution": "Use result.continueCursor from previous paginate() call",
        "doc_url": "/docs/db/orm/ordering-pagination#cursor-pagination",
        "severity": "error"
      }
    },
    "migration_errors": {
      "drizzle_findUnique": {
        "pattern": "db(...).query.users.findUnique is not a function",
        "message": "findUnique not available - use findFirst with where",
        "drizzle_code": "findUnique({ where: { id: userId } })",
        "convex_code": "findFirst({ where: eq(users._id, userId) })",
        "doc_url": "/docs/db/orm/from-drizzle#find-operations",
        "severity": "error"
      },
      "drizzle_include": {
        "pattern": "Object literal may only specify known properties, and 'include' does not exist",
        "message": "Use 'with' instead of 'include' for relations",
        "drizzle_code": "include: { posts: true }",
        "convex_code": "with: { posts: true }",
        "doc_url": "/docs/db/orm/from-drizzle#relation-loading",
        "severity": "error"
      },
      "drizzle_take": {
        "pattern": "Object literal may only specify known properties, and 'take' does not exist",
        "message": "Use 'limit' instead of 'take'",
        "drizzle_code": "take: 10",
        "convex_code": "limit: 10",
        "doc_url": "/docs/db/orm/from-drizzle#complete-api-mapping",
        "severity": "error"
      },
      "drizzle_skip": {
        "pattern": "Object literal may only specify known properties, and 'skip' does not exist",
        "message": "Use 'offset' instead of 'skip'",
        "drizzle_code": "skip: 20",
        "convex_code": "offset: 20",
        "doc_url": "/docs/db/orm/from-drizzle#complete-api-mapping",
        "severity": "error"
      },
      "prisma_create": {
        "pattern": "db(...).insert.users.create is not a function",
        "message": "Use values() instead of create() for inserts",
        "prisma_code": "prisma.user.create({ data: {...} })",
        "convex_code": "db(ctx).insert.users.values({...})",
        "doc_url": "/docs/db/orm/from-prisma#create",
        "severity": "error"
      },
      "prisma_null": {
        "pattern": "Type 'null' is not assignable",
        "message": "Prisma uses null, Convex uses undefined",
        "prisma_code": "age: null",
        "convex_code": "age: undefined",
        "doc_url": "/docs/db/orm/from-prisma#null-vs-undefined",
        "severity": "error"
      }
    },
    "performance_warnings": {
      "n_plus_1_warning": {
        "pattern": "Multiple queries detected for relation",
        "message": "Potential N+1 query - use 'with' for eager loading",
        "solution": "Load relations with 'with' instead of separate queries",
        "doc_url": "/docs/db/orm/queries#n1-prevention",
        "severity": "warning"
      },
      "deep_offset_warning": {
        "pattern": "Offset pagination beyond 1000 records",
        "message": "Deep offset pagination is slow - use cursor pagination",
        "solution": "Switch to paginate() for better performance",
        "doc_url": "/docs/db/orm/ordering-pagination#performance-comparison",
        "severity": "warning"
      },
      "missing_index_warning": {
        "pattern": "Query without index on field",
        "message": "Non-indexed field in where clause - may be slow",
        "solution": "Add Convex index or use indexed field",
        "doc_url": "/docs/db/orm/queries#performance-considerations",
        "severity": "warning"
      }
    },
    "common_gotchas": {
      "auto_fields": {
        "issue": "Providing _id or _creationTime in insert",
        "message": "These fields are auto-generated by Convex",
        "solution": "Remove _id and _creationTime from values()",
        "doc_url": "/docs/db/orm/schema#auto-generated-fields",
        "severity": "info"
      },
      "relation_field_name": {
        "issue": "Relation field name mismatch",
        "message": "Foreign key field must match relation config",
        "example": "If relation uses posts.userId, field must be userId not authorId",
        "doc_url": "/docs/db/orm/schema#relation-field-naming",
        "severity": "info"
      },
      "circular_relations": {
        "issue": "Circular dependency in schema imports",
        "message": "Define tables and relations in same file or use forward refs",
        "solution": "Keep table definitions and relations together",
        "doc_url": "/docs/db/orm/schema#schema-organization",
        "severity": "info"
      }
    }
  },
  "troubleshooting_steps": [
    {
      "step": 1,
      "action": "Check error message pattern in catalog",
      "description": "Match TypeScript error to known patterns above"
    },
    {
      "step": 2,
      "action": "Review schema definition",
      "description": "Verify table and relation definitions match usage"
    },
    {
      "step": 3,
      "action": "Compare with migration guide",
      "description": "If migrating from Drizzle/Prisma, check API mapping tables"
    },
    {
      "step": 4,
      "action": "Enable verbose logging",
      "description": "Use bun convex:logs to see runtime errors"
    },
    {
      "step": 5,
      "action": "Check type inference",
      "description": "Hover in IDE to see inferred types match expectations"
    }
  ],
  "quick_fixes": {
    "null_to_undefined": {
      "find": ": null",
      "replace": ": undefined",
      "context": "Optional field values"
    },
    "include_to_with": {
      "find": "include:",
      "replace": "with:",
      "context": "Relation loading"
    },
    "take_to_limit": {
      "find": "take:",
      "replace": "limit:",
      "context": "Result limiting"
    },
    "skip_to_offset": {
      "find": "skip:",
      "replace": "offset:",
      "context": "Pagination"
    },
    "findUnique_to_findFirst": {
      "find": ".findUnique({",
      "replace": ".findFirst({ where: eq(",
      "context": "Unique lookups"
    }
  }
}

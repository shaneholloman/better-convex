---
title: Quickstart
description: Get Better Convex running in 5 minutes.
links:
  doc: https://docs.convex.dev/quickstart
---

import { InfoIcon } from "lucide-react"

In this guide, we'll get Better Convex running from scratch. You'll set up a Next.js app with Convex, create your first cRPC procedures, and use them with TanStack Query.

<Callout icon={<InfoIcon />}>
Docs use the ORM (`ctx.orm`) everywhere. If you're migrating from native Convex, see
[/docs/migrations/db](/docs/migrations/db).
</Callout>

## Create Next.js App

```bash showLineNumbers
bunx create-next-app@latest my-app --typescript --tailwind --eslint --app --src-dir
cd my-app
```

## Installation

```bash
bun add convex better-convex zod @tanstack/react-query
```

## Configure Folder Structure

Better Convex uses a specific folder structure. Create `convex.json`:

```json title="convex.json" showLineNumbers {2-5}
{
  "functions": "convex/functions",
  "codegen": {
    "staticApi": true,
    "staticDataModel": true
  }
}
```

<Callout icon={<InfoIcon />}>
The `codegen.staticApi` setting is required for TypeScript types to work correctly with cRPC.
</Callout>

This enables the recommended structure:

```plaintext showLineNumbers
convex/
├── functions/           # Convex functions (configured above)
│   ├── _generated/      # api.ts, dataModel.ts
│   ├── schema.ts        # Database schema
│   └── *.ts             # Procedures
├── lib/                 # Server helpers (NOT deployed)
│   └── crpc.ts          # cRPC builder
└── shared/              # Client-importable
    └── meta.ts          # Generated procedure metadata
```

Create these folders:

```bash
mkdir -p convex/functions convex/lib src/lib/convex
```

Next, add these settings to your existing `tsconfig.json`:

```json title="tsconfig.json" showLineNumbers {3,5-6}
{
  "compilerOptions": {
    "strict": true,
    "strictFunctionTypes": false,
    "paths": {
      "@/*": ["./src/*"],
      "@convex/*": ["./convex/functions/_generated/*", "./convex/shared/*"]
    }
  }
}
```

<Callout icon={<InfoIcon />}>
`strictFunctionTypes: false` is required for middleware type inference to work correctly.
</Callout>

See [Concepts](/docs/concepts) for detailed folder structure explanation.

## 1. Define Schema

We'll start by defining tables and relations in one file.

```ts title="convex/functions/schema.ts" showLineNumbers {3-8,10-15,17-22}
import {
  boolean,
  convexTable,
  defineRelations,
  defineSchema,
  id,
  index,
  text,
} from 'better-convex/orm';

export const user = convexTable('user', {
  name: text().notNull(),
  email: text().notNull(),
});

export const posts = convexTable(
  'posts',
  {
    title: text().notNull(),
    published: boolean(),
    userId: id('user').notNull(),
  },
  (t) => [index('by_user').on(t.userId)]
);

const tables = { user, posts };
export default defineSchema(tables, { strict: false });

export const relations = defineRelations(tables, (r) => ({
  user: { posts: r.many.posts() },
  posts: { author: r.one.user({ from: r.posts.userId, to: r.user.id }) },
}));
```

<Callout icon={<InfoIcon />}>
Docs use `strict: false` to keep snippets short. Keep strict default and add indexes in real apps.
</Callout>

## 2. Initialize Convex

Start the Better Convex dev server:

```bash showLineNumbers
bunx better-convex dev
```

This generates `convex/functions/_generated/` (types) and `convex/shared/meta.ts` (procedure metadata). Keep it running in a separate terminal.

<Callout icon={<InfoIcon />}>
For one-time codegen without watch mode, use `bunx better-convex codegen`.
</Callout>

## Environment Variables

Create `.env.local` with your Convex URLs:

<Tabs groupId="env" items={["Local", "Cloud"]} persist>
  <Tab value="Local">
    ```bash title=".env.local"
    # WebSocket API (port 3210)
    NEXT_PUBLIC_CONVEX_URL=http://localhost:3210

    # HTTP routes (port 3211)
    NEXT_PUBLIC_CONVEX_SITE_URL=http://localhost:3211
    ```
  </Tab>
  <Tab value="Cloud">
    ```bash title=".env.local"
    # Generated by Convex
    NEXT_PUBLIC_CONVEX_URL=https://your-project.convex.cloud

    # Add manually - replace .cloud with .site
    NEXT_PUBLIC_CONVEX_SITE_URL=https://your-project.convex.site
    ```
  </Tab>
</Tabs>

## 3. Create ORM + cRPC Builder

First, attach the ORM to your context. Create `convex/lib/orm.ts`:

```ts title="convex/lib/orm.ts" showLineNumbers {1-3,5-6,8-11}
import { createOrm } from 'better-convex/orm';
import type { MutationCtx, QueryCtx } from '../functions/_generated/server';
import { relations } from '../functions/schema';

export const orm = createOrm({ schema: relations });

export const withOrm = <Ctx extends QueryCtx | MutationCtx>(ctx: Ctx) => ({
  ...ctx,
  orm: orm.db(ctx),
});
```

Now create the cRPC builder in `convex/lib/crpc.ts`:

```ts title="convex/lib/crpc.ts" showLineNumbers {1,10-12,15-27,29-30}
import { initCRPC } from 'better-convex/server';
import type {
  ActionCtx,
  MutationCtx,
  QueryCtx,
} from '../functions/_generated/server';
import type { DataModel } from '../functions/_generated/dataModel';
import { withOrm } from './orm';


const c = initCRPC
  .dataModel<DataModel>()
  .context({
    query: (ctx) => withOrm(ctx),
    mutation: (ctx) => withOrm(ctx),
  })
  .create();

export const publicQuery = c.query;
export const publicMutation = c.mutation;
```

## 4. Define Procedures

```ts title="convex/functions/user.ts" showLineNumbers {1-4,6-27,29-40}
import { z } from 'zod';
import { publicQuery, publicMutation } from '../lib/crpc';
import { user } from './schema';

export const list = publicQuery
  .input(z.object({ limit: z.number().optional() }))
  .output(
    z.array(
      z.object({
        id: z.string(),
        createdAt: z.date(),
        name: z.string(),
        email: z.string(),
        posts: z.array(
          z.object({
            id: z.string(),
            createdAt: z.date(),
            title: z.string(),
            published: z.boolean().nullable(),
          })
        ),
      })
    )
  )
  .query(async ({ ctx, input }) => {
    return ctx.orm.query.user.findMany({
      limit: input.limit ?? 10,
      with: {
        posts: {
          limit: 5,
          orderBy: { createdAt: 'desc' },
          columns: {
            id: true,
            createdAt: true,
            title: true,
            published: true,
          },
        },
      },
    });
  });

export const create = publicMutation
  .input(z.object({ name: z.string(), email: z.string() }))
  .output(z.string())
  .mutation(async ({ ctx, input }) => {
    const [row] = await ctx.orm
      .insert(user)
      .values(input)
      .returning({ id: user.id });
    return row.id;
  });
```

<Callout icon={<InfoIcon />}>
The `.output()` schema is required for proper TypeScript inference when using `staticApi` codegen.
</Callout>

## 5. Set Up Client

```tsx title="src/lib/convex/crpc.tsx" showLineNumbers {1-3,5-8}
import { api } from '@convex/api';
import { meta } from '@convex/meta';
import { createCRPCContext } from 'better-convex/react';

export const { CRPCProvider, useCRPC, useCRPCClient } = createCRPCContext<typeof api>({
  api,
  meta,
  convexSiteUrl: process.env.NEXT_PUBLIC_CONVEX_SITE_URL!,
});
```

Wrap your app:

```tsx title="src/app/providers.tsx" showLineNumbers {3-8,10,12-14,17-20,23-25}
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import {
  ConvexProvider,
  ConvexReactClient,
  getQueryClientSingleton,
  getConvexQueryClientSingleton,
} from 'better-convex/react';
import { CRPCProvider } from '@/lib/convex/crpc';

const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

function createQueryClient() {
  return new QueryClient({
    defaultOptions: { queries: { staleTime: Infinity } },
  });
}

export function Providers({ children }: { children: React.ReactNode }) {
  return (
    <ConvexProvider client={convex}>
      <QueryProvider>{children}</QueryProvider>
    </ConvexProvider>
  );
}

function QueryProvider({ children }: { children: React.ReactNode }) {
  const queryClient = getQueryClientSingleton(createQueryClient);
  const convexQueryClient = getConvexQueryClientSingleton({
    convex,
    queryClient,
  });

  return (
    <QueryClientProvider client={queryClient}>
      <CRPCProvider
        convexClient={convex}
        convexQueryClient={convexQueryClient}
      >
        {children}
      </CRPCProvider>
    </QueryClientProvider>
  );
}
```

Finally, update your existing `src/app/layout.tsx` to wrap the app with providers:

```tsx title="src/app/layout.tsx" showLineNumbers {1,7}
import { Providers } from './providers';

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  );
}
```

## 6. Use It

```tsx title="src/app/user/page.tsx" showLineNumbers {3-4,6,8-10,12,16-18}
'use client';

import { useQuery, useMutation } from '@tanstack/react-query';
import { useCRPC } from '@/lib/convex/crpc';

export default function UserPage() {
  const crpc = useCRPC();

  const { data: users, isPending } = useQuery(
    crpc.user.list.queryOptions({ limit: 10 })
  );

  const createUser = useMutation(crpc.user.create.mutationOptions());

  if (isPending) return <div>Loading...</div>;

  return (
    <div>
      <button
        onClick={() => createUser.mutate({ name: 'John', email: 'john@example.com' })}
      >
        Create User
      </button>
      {users?.map((user) => (
        <div key={user.id}>{user.name}</div>
      ))}
    </div>
  );
}
```

## 7. Run the App

Start Next.js and open [http://localhost:3000/user](http://localhost:3000/user):

```bash
bun dev
```

## Next Steps

You have a working Better Convex app. Add more features:

<Cards>
  <Card title="Add Auth" href="/docs/auth/server" />
  <Card title="Add Triggers" href="/docs/orm/triggers" />
  <Card title="Add Rate Limiting" href="/docs/server/advanced/rate-limiting" />
  <Card title="Full Templates" href="/docs/templates" />
</Cards>

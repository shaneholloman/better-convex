---
title: Drizzle Comparison
description: Side-by-side API comparison between Drizzle ORM and Better-Convex with migration guide
links:
  doc: https://orm.drizzle.team
---

import { InfoIcon, CheckCircle, AlertTriangle } from "lucide-react"

This guide compares Drizzle v1 and Better-Convex ORM side-by-side. It focuses on API mapping and the behavioral differences that matter when moving from SQL to Convex.

## At A Glance

**Same API surface:**
- Table builders and relations (`convexTable`, `defineRelations`, `one`, `many`)
- Relational query builder (`findMany`, `findFirst`, `where`, `orderBy`, `limit`, `offset`, `with`)
- Type inference (`InferSelectModel`, `InferInsertModel`, `$inferSelect`, `$inferInsert`)
- Mutation helpers (`insert`, `update`, `delete`, `returning`, `onConflictDoUpdate`)

**Different behavior:**
- `_id` is auto-created (no manual `id` column)
- Fields are nullable by default (`text()` yields `string | null`)
- `columns` projection and string operators run post-fetch
- Relation filters and ordering for `many()` run post-fetch
- Cursor pagination uses the first `orderBy` field and requires indexes for stable ordering

**Not available in Convex:**
- SQL joins and raw SQL execution
- Database migrations and constraints
- Custom SQL data types
- Table introspection helpers (`getTableConfig`, `getTableColumns`)

## Migration Checklist

- [ ] Install `better-convex`
- [ ] Convert table definitions to `convexTable()` with column builders (`text`, `integer`, `boolean`, `id`)
- [ ] Replace manual `id` fields with Convex `_id`
- [ ] Define relations using `defineRelations()` and `with`
- [ ] Create a DB instance with `createDatabase(ctx.db, ormSchema, ormEdges)`
- [ ] Keep `where`, `orderBy`, `limit`, `offset` shapes the same
- [ ] Move joins to relation loading (`with`)

## Schema Definition

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts
    import { pgTable, serial, text, integer, boolean } from 'drizzle-orm/pg-core';

    const users = pgTable('users', {
      id: serial('id').primaryKey(),
      name: text('name').notNull(),
      email: text('email').notNull(),
      age: integer('age'),
      isAdmin: boolean('is_admin').default(false),
    });

    const posts = pgTable('posts', {
      id: serial('id').primaryKey(),
      title: text('title').notNull(),
      content: text('content').notNull(),
      published: boolean('published').default(false),
      userId: integer('user_id').references(() => users.id),
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    import { convexTable, text, integer, boolean, id } from 'better-convex/orm';

    const users = convexTable('users', {
      // _id is auto-created as Id<'users'>
      name: text().notNull(),
      email: text().notNull(),
      age: integer(),
      isAdmin: boolean(),
    });

    const posts = convexTable('posts', {
      // _id is auto-created as Id<'posts'>
      title: text().notNull(),
      content: text().notNull(),
      published: boolean(),
      userId: id('users'),
    });
    ```
  </Tab>
</Tabs>

**Key changes:**
- IDs are auto-created as `_id`
- Nullable by default unless `.notNull()` is used
- Foreign keys are `id('table')`

## Relations

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts
    import { defineRelations } from 'drizzle-orm';

    export const relations = defineRelations({ users, posts }, (r) => ({
      users: {
        posts: r.many.posts(),
      },
      posts: {
        author: r.one.users({
          from: r.posts.userId,
          to: r.users.id,
        }),
      },
    }));
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    import { defineRelations, extractRelationsConfig } from 'better-convex/orm';

    export const ormSchema = defineRelations({ users, posts }, (r) => ({
      users: {
        posts: r.many.posts(),
      },
      posts: {
        author: r.one.users({
          from: r.posts.userId,
          to: r.users._id,
        }),
      },
    }));

    export const ormEdges = extractRelationsConfig(ormSchema);
    ```
  </Tab>
</Tabs>

## Queries

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts
    const users = await db.query.users.findMany();

    const user = await db.query.users.findFirst({
      where: { email: 'alice@example.com' },
    });

    const admins = await db.query.users.findMany({
      where: {
        role: 'admin',
        lastSeen: { gt: Date.now() - 86_400_000 },
      },
      orderBy: { lastSeen: 'desc' },
      limit: 10,
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    import { createDatabase } from 'better-convex/orm';
    import { ormSchema, ormEdges } from './schema';

    const db = createDatabase(ctx.db, ormSchema, ormEdges);

    const users = await db.query.users.findMany();

    const user = await db.query.users.findFirst({
      where: { email: 'alice@example.com' },
    });

    const admins = await db.query.users.findMany({
      where: {
        role: 'admin',
        lastSeen: { gt: Date.now() - 86_400_000 },
      },
      orderBy: { lastSeen: 'desc' },
      limit: 10,
    });
    ```
  </Tab>
</Tabs>

## API Mapping

| Drizzle v1 | Better-Convex | Notes |
|---|---|---|
| `pgTable()` / `mysqlTable()` / `sqliteTable()` | `convexTable()` | Same surface | 
| `defineRelations()` | `defineRelations()` | Same surface |
| `db.query.*.findMany()` | `db.query.*.findMany()` | Same surface via `createDatabase` |
| `db.query.*.findFirst()` | `db.query.*.findFirst()` | Same surface via `createDatabase` |
| `where` object filters | `where` object filters | Same shape |
| `orderBy` | `orderBy` | Same shape, index-aware |
| `columns` | `columns` | Post-fetch projection |
| `with` | `with` | Relation loading |
| `insert/update/delete` | `insert/update/delete` | Same surface |
| SQL joins | Not available | Use `with` |
| Raw SQL | Not available | Convex is document-based |
| Custom types | Not available | Use app-level encoding |
| Table introspection | Not available | Use your schema object |

## Differences To Note

- Better-Convex runs on Convex documents, not SQL tables
- `_id` and `_creationTime` are always present
- Nullable is the default, `.notNull()` makes fields required
- `columns`, string operators, and relation filters are post-fetch
- Cursor pagination requires an index on the primary `orderBy` field

## Migration Gotchas

| Gotcha | Fix |
|---|---|
| **No `db` instance** | Use `createDatabase(ctx.db, ormSchema, ormEdges)` |
| **`id` vs `_id`** | Convex uses `_id` for primary keys |
| **Nullable fields** | Types include `null` unless `.notNull()` |
| **No SQL joins** | Use `with` relation loading |
| **Missing index for ordering** | Add `.index()` in schema |
| **Custom SQL types** | Use app-level encoding |

## Next Steps

<Cards>
  <Card title="Schema Definition" href="/docs/db/orm/schema">
    Define tables, relations, and indexes
  </Card>
  <Card title="Querying Data" href="/docs/db/orm/queries">
    Learn filters, ordering, and pagination
  </Card>
  <Card title="Limitations" href="/docs/db/orm/limitations">
    Understand differences and tradeoffs
  </Card>
</Cards>

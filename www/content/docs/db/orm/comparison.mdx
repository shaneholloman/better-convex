---
title: Drizzle Comparison
description: Side-by-side API comparison between Drizzle ORM and Better-Convex with migration guide
links:
  doc: https://orm.drizzle.team
---

This guide compares Drizzle v1 and Better-Convex ORM side-by-side. It focuses on API mapping and the behavioral differences that matter when moving from SQL to Convex.

## At A Glance

**Same API surface:**
- Table builders and relations (`convexTable`, `defineRelations`, `one`, `many`)
- Relational query builder (`findMany`, `findFirst`, `where`, `orderBy`, `limit`, `offset`, `with`)
- Type inference (`InferSelectModel`, `InferInsertModel`, `$inferSelect`, `$inferInsert`)
- Mutation helpers (`insert`, `update`, `delete`, `returning`, `onConflictDoUpdate`)

**Different behavior:**
- `_id` is auto-created (no manual `id` column)
- Fields are nullable by default (`text()` yields `string | null`)
- `columns` projection and string operators run post-fetch
- Relation filters and ordering for `many()` run post-fetch
- Unique and foreign keys (including FK actions) are enforced by ORM mutations, not SQL
- Cursor pagination uses the first `orderBy` field and requires indexes for stable ordering

**Not available in Convex:**
- SQL joins and raw SQL execution
- Database migrations and database-side constraints/triggers
- Custom SQL data types
- ORM query-builder aggregations (`count`, `sum`, `avg`, `max`, `min`) should use Convex aggregate components

## Convex‑Ents Compatibility

Better‑Convex is designed as a successor to Convex‑Ents, but it follows Drizzle’s query‑builder model rather than Ent‑object APIs.

**What maps cleanly:**
- Relations and relational reads (`with`) replace `edge()`/`edgeX()` traversal
- Runtime constraints (unique / foreign key / check) are enforced by ORM mutations
- Soft and scheduled deletes are supported
- Many‑to‑many with data uses an explicit join table with payload fields

**What’s intentionally different:**
- No ent‑object API (`getX()`, `patch()`, lazy promises); use `ctx.orm.query.*` and mutation builders
- No edge methods on loaded rows; use relation loading + mutation builders

See [Migrate from native Convex](/docs/db/orm/migrate-from-convex) (for `ctx.db`) or [Migrate from Convex Ents](/docs/db/orm/migrate-from-ents) (for `ctx.table`) for step‑by‑step mappings.

**Concurrency note:** uniqueness is best‑effort within a mutation; concurrent mutations can still race. Prefer `onConflictDoNothing()` / retries or serialize writes per key when strict guarantees are required.

## Migration Checklist

- [ ] Install `better-convex`
- [ ] Convert table definitions to `convexTable()` with column builders (`text`, `integer`, `boolean`, `id`)
- [ ] Replace manual `id` fields with Convex `_id`
- [ ] Define relations using `defineRelations()` and `with`
- [ ] Attach ORM to `ctx.orm` in context (create once)
- [ ] Keep `where`, `orderBy`, `limit`, `offset` shapes the same
- [ ] Move joins to relation loading (`with`)

## Schema Definition

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts showLineNumbers
    import { pgTable, serial, text, integer, boolean } from 'drizzle-orm/pg-core';

    const users = pgTable('users', {
      id: serial('id').primaryKey(),
      name: text('name').notNull(),
      email: text('email').notNull(),
      age: integer('age'),
      isAdmin: boolean('is_admin').default(false),
    });

    const posts = pgTable('posts', {
      id: serial('id').primaryKey(),
      title: text('title').notNull(),
      content: text('content').notNull(),
      published: boolean('published').default(false),
      userId: integer('user_id').references(() => users.id),
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts showLineNumbers
    import { convexTable, text, integer, boolean, id } from 'better-convex/orm';

    const users = convexTable('users', {
      // _id is auto-created as Id<'users'>
      name: text().notNull(),
      email: text().notNull(),
      age: integer(),
      isAdmin: boolean(),
    });

    const posts = convexTable('posts', {
      // _id is auto-created as Id<'posts'>
      title: text().notNull(),
      content: text().notNull(),
      published: boolean(),
      userId: id('users'),
    });
    ```
  </Tab>
</Tabs>

**Key changes:**
- IDs are auto-created as `_id`
- Nullable by default unless `.notNull()` is used
- Foreign keys are `id('table')`

## Relations

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts showLineNumbers
    import { defineRelations } from 'drizzle-orm';

    export const relations = defineRelations({ users, posts }, (r) => ({
      users: {
        posts: r.many.posts(),
      },
      posts: {
        author: r.one.users({
          from: r.posts.userId,
          to: r.users.id,
        }),
      },
    }));
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts showLineNumbers {11}
    import { defineRelations } from 'better-convex/orm';

    export const relations = defineRelations({ users, posts }, (r) => ({
      users: {
        posts: r.many.posts(),
      },
      posts: {
        author: r.one.users({
          from: r.posts.userId,
          to: r.users._id,
        }),
      },
    }));
    ```
  </Tab>
</Tabs>

## Queries

<Tabs groupId="migration" items={['Drizzle', 'Better-Convex']} persist>
  <Tab value="Drizzle">
    ```ts showLineNumbers
    const users = await db.query.users.findMany();

    const user = await db.query.users.findFirst({
      where: { id: userId },
    });

    const admins = await db.query.users.findMany({
      where: { role: 'admin' },
      orderBy: { createdAt: 'desc' },
      limit: 10,
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts showLineNumbers {1}
    const db = ctx.orm;

    const users = await db.query.users.findMany({ limit: 50 });

    const user = await db.query.users.findFirst({
      where: { _id: userId },
    });

    // Schema: index('by_role').on(t.role) on users table
    const admins = await db.query.users.findMany({
      where: { role: 'admin' },
      orderBy: { _creationTime: 'desc' },
      limit: 10,
    });
    ```
  </Tab>
</Tabs>

## API Mapping

| Drizzle v1 | Better-Convex | Notes |
|---|---|---|
| `pgTable()` / `mysqlTable()` / `sqliteTable()` | `convexTable()` | Same surface | 
| `defineRelations()` | `defineRelations()` | Same surface |
| `db.query.*.findMany()` | `db.query.*.findMany()` | Same surface via `ctx.orm` |
| `db.query.*.findFirst()` | `db.query.*.findFirst()` | Same surface via `ctx.orm` |
| `where` object filters | `where` object filters | Same shape |
| `orderBy` | `orderBy` | Same shape, index-aware |
| `columns` | `columns` | Post-fetch projection |
| `with` | `with` | Relation loading |
| `insert/update/delete` | `insert/update/delete` | Same surface |
| `count/sum/avg/max/min` in query builder | Use components | Use [Aggregates](/docs/db/aggregates) (`@convex-dev/aggregate`) |
| SQL joins | Not available | Use `with` |
| Raw SQL | Not available | Convex is document-based |
| Custom types | Not available | Use app-level encoding |
| Table introspection | `getTableColumns`, `getTableConfig` | Runtime metadata helpers |

## Differences To Note

- Better-Convex runs on Convex documents, not SQL tables
- `_id` and `_creationTime` are always present
- Nullable is the default, `.notNull()` makes fields required
- `columns`, string operators, and relation filters are post-fetch
- Cursor pagination requires an index on the primary `orderBy` field

## Migration Gotchas

| Gotcha | Fix |
|---|---|
| **`ctx.orm` is missing** | Attach ORM once in context (`createOrm({ schema }).db(ctx)`) |
| **`id` vs `_id`** | Convex uses `_id` for primary keys |
| **Nullable fields** | Types include `null` unless `.notNull()` |
| **No SQL joins** | Use `with` relation loading |
| **Missing index for ordering** | Add `index('...').on(t.field)` in schema |
| **Custom SQL types** | Use app-level encoding |

## Next Steps

<Cards>
  <Card title="Schema Definition" href="/docs/db/orm/schema">
    Define tables, relations, and indexes
  </Card>
  <Card title="Querying Data" href="/docs/db/orm/queries">
    Learn filters, ordering, and pagination
  </Card>
  <Card title="Limitations" href="/docs/db/orm/limitations">
    Understand differences and tradeoffs
  </Card>
</Cards>

---
title: Drizzle Comparison
description: Side-by-side API comparison between Drizzle ORM and Better-Convex with migration guide
links:
  doc: https://orm.drizzle.team
---

import { InfoIcon, CheckCircle, AlertTriangle } from "lucide-react"

Compare Drizzle ORM and Better-Convex ORM APIs side-by-side. This guide shows exact API mappings and migration paths for Drizzle developers.

## API Compatibility Overview

**Current Implementation (M1-M4)**:
- ‚úÖ Schema definition (`convexTable`, field types)
- ‚úÖ Relations definition (`one()`, `many()`)
- ‚úÖ Query builder (`findMany`, `findFirst`)
- ‚úÖ Where filtering (all operators)
- ‚úÖ Type inference

**Coming Soon (M5+)**:
- üöß Relation loading with `with:`
- üöß Mutations (`insert`, `update`, `delete`)
- üöß Order by

### Migration Checklist (M1-M4)

- [ ] Install `better-convex`
- [ ] Convert table definitions to `convexTable()` with `v.*` validators
- [ ] Define relations using `relations()` (definition only, not loading)
- [ ] Update imports from `drizzle-orm` to `better-convex/orm`
- [ ] Replace `db.query` with `db(ctx).query`
- [ ] Use where filtering (`eq`, `gt`, etc.)
- [ ] Remove `with:` relation loading (use native Convex queries for now)
- [ ] Remove `orderBy` (sort after fetching for now)
- [ ] Remove column selection (Convex returns full documents)
- [ ] Test queries with type checking

## Installation

<Tabs groupId="package-manager" items={["npm", "pnpm", "yarn", "bun"]} persist>
  <Tab value="npm">
    ```bash
    npm install better-convex
    npm uninstall drizzle-orm # Optional
    ```
  </Tab>
  <Tab value="pnpm">
    ```bash
    pnpm add better-convex
    pnpm remove drizzle-orm # Optional
    ```
  </Tab>
  <Tab value="yarn">
    ```bash
    yarn add better-convex
    yarn remove drizzle-orm # Optional
    ```
  </Tab>
  <Tab value="bun">
    ```bash
    bun add better-convex
    bun remove drizzle-orm # Optional
    ```
  </Tab>
</Tabs>

## API Migration Guide

### Schema Definition

<Tabs groupId="migration" items={["Drizzle", "Better-Convex"]} persist>
  <Tab value="Drizzle">
    ```ts
    import { pgTable, serial, text, integer, boolean } from 'drizzle-orm/pg-core';

    const users = pgTable('users', {
      id: serial('id').primaryKey(),
      name: text('name').notNull(),
      email: text('email').notNull(),
      age: integer('age'),
      isAdmin: boolean('is_admin').default(false),
    });

    const posts = pgTable('posts', {
      id: serial('id').primaryKey(),
      title: text('title').notNull(),
      content: text('content').notNull(),
      published: boolean('published').default(false),
      userId: integer('user_id').references(() => users.id),
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    import { convexTable, text, integer, boolean } from 'better-convex/orm';

    const users = convexTable('users', {
      // id is auto-created as _id: Id<'users'>
      name: text().notNull(),
      email: text().notNull(),
      age: integer(),
      isAdmin: boolean(), // Nullable by default
    });

    const posts = convexTable('posts', {
      // id is auto-created as _id: Id<'posts'>
      title: text().notNull(),
      content: text().notNull(),
      published: boolean(),
      // userId will be created by relation
    });
    ```
  </Tab>
</Tabs>

**Key Changes:**
- **IDs**: Use auto-generated `_id` instead of manual `id` field
- **Types**: Use `v.*` validators instead of column builders (M1-M5)
- **Not Null**: Fields are required by default, use `v.optional()` for optional
- **Defaults**: Not yet supported - set in application code
- **Foreign Keys**: Created automatically by relations

### Relations

<Tabs groupId="migration" items={["Drizzle", "Better-Convex"]} persist>
  <Tab value="Drizzle">
    ```ts
    import { relations } from 'drizzle-orm';

    const usersRelations = relations(users, ({ many }) => ({
      posts: many(posts),
    }));

    const postsRelations = relations(posts, ({ one }) => ({
      author: one(users, {
        fields: [posts.userId],
        references: [users.id],
      }),
    }));
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    import { relations } from 'better-convex/orm';

    const usersRelations = relations(users, ({ many }) => ({
      posts: many(posts),
    }));

    const postsRelations = relations(posts, ({ one }) => ({
      author: one(users, {
        fields: [posts.userId],
        references: [users._id], // Use _id instead of id
      }),
    }));
    ```
  </Tab>
</Tabs>

**Key Changes:**
- **API**: 100% identical except `_id` vs `id`
- **Import**: `better-convex/orm` instead of `drizzle-orm`

### Queries (M1-M4)

<Tabs groupId="migration" items={["Drizzle", "Better-Convex"]} persist>
  <Tab value="Drizzle">
    ```ts
    // Find many
    const users = await db.query.users.findMany();

    // Find first
    const user = await db.query.users.findFirst({
      where: eq(users.email, 'alice@example.com'),
    });

    // Complex filtering
    const admins = await db.query.users.findMany({
      where: and(
        eq(users.role, 'admin'),
        gt(users.lastSeen, Date.now() - 86400000)
      ),
    });

    // With limit
    const recent = await db.query.posts.findMany({
      where: eq(posts.published, true),
      limit: 10,
    });
    ```
  </Tab>
  <Tab value="Better-Convex">
    ```ts
    // Find many (add ctx parameter!)
    const users = await db(ctx).query.users.findMany();

    // Find first (identical!)
    const user = await db(ctx).query.users.findFirst({
      where: eq(users.email, 'alice@example.com'),
    });

    // Complex filtering (identical!)
    const admins = await db(ctx).query.users.findMany({
      where: and(
        eq(users.role, 'admin'),
        gt(users.lastSeen, Date.now() - 86400000)
      ),
    });

    // With limit (identical!)
    const recent = await db(ctx).query.posts.findMany({
      where: eq(posts.published, true),
      limit: 10,
    });
    ```
  </Tab>
</Tabs>

**Key Changes:**
- **Context**: Add `ctx` parameter to `db(ctx)`
- **Everything else**: 100% identical API for findMany, findFirst, where, limit, offset

### Mutations (üöß Coming in M5-M6)

<Callout icon={<AlertTriangle />}>
**Not Yet Implemented**: Mutation APIs (`insert`, `update`, `delete`) are planned for M5-M6. Use [native Convex mutations](https://docs.convex.dev/database/writing-data) for now.
</Callout>

<Tabs groupId="migration" items={["Drizzle", "Planned Better-Convex API"]} persist>
  <Tab value="Drizzle">
    ```ts
    // Insert
    const [user] = await db.insert(users)
      .values({ name: 'Alice', email: 'alice@example.com' })
      .returning();

    // Update
    await db.update(users)
      .set({ name: 'Alice Smith' })
      .where(eq(users.id, userId));

    // Delete
    await db.delete(users)
      .where(eq(users.id, userId));
    ```
  </Tab>
  <Tab value="Planned Better-Convex API">
    ```ts
    // Insert (planned - will auto-return ID)
    const userId = await db(ctx).insert.users
      .values({ name: 'Alice', email: 'alice@example.com' });

    // Update (planned)
    await db(ctx).update.users
      .set({ name: 'Alice Smith' })
      .where(eq(users._id, userId));

    // Delete (planned)
    await db(ctx).delete.users
      .where(eq(users._id, userId));
    ```
  </Tab>
</Tabs>

**Planned Changes:**
- **Insert**: Will auto-return ID (no `.returning()` needed)
- **IDs**: Use `_id` field instead of `id`

**Current Workaround**: Use native Convex mutations (`ctx.db.insert`, `ctx.db.patch`, `ctx.db.delete`)

## Complete API Mapping

| Drizzle API | Better-Convex API | Compatibility |
|-------------|-------------------|---------------|
| `pgTable()` / `mysqlTable()` | `convexTable()` | ‚úÖ API identical |
| `relations()` | `relations()` | ‚úÖ 100% identical |
| `db.query.*.findMany()` | `db(ctx).query.*.findMany()` | ‚úÖ Add ctx |
| `db.query.*.findFirst()` | `db(ctx).query.*.findFirst()` | ‚úÖ Add ctx |
| `db.insert().values()` | `db(ctx).insert.*.values()` | ‚úÖ Add ctx |
| `db.update().set().where()` | `db(ctx).update.*.set().where()` | ‚úÖ Add ctx |
| `db.delete().where()` | `db(ctx).delete.*.where()` | ‚úÖ Add ctx |
| `eq()`, `ne()`, `gt()`, etc. | Same | ‚úÖ 100% identical |
| `and()`, `or()`, `not()` | Same | ‚úÖ 100% identical |
| `with` (relations) | `with` | ‚úÖ 100% identical |
| `where` (filtering) | `where` | ‚úÖ 100% identical |
| `limit` / `offset` | `limit` / `offset` | ‚úÖ 100% identical |
| `orderBy()` | `orderBy()` | ‚úÖ See docs |
| `.select()` (columns) | ‚ùå Not supported | ‚ö†Ô∏è Use post-filter |
| `like()` / `ilike()` | ‚ùå Not supported | ‚ö†Ô∏è Use search or post-filter |
| Raw SQL | ‚ùå Not supported | ‚ùå Convex uses documents |
| Migrations | ‚ùå Not supported | ‚ùå Convex is schemaless |

## Feature Categories

### Category 1: ‚úÖ 100% Compatible

These APIs work identically in both Drizzle and Better-Convex:

**Schema:**
- Table definitions
- Relations (`one()`, `many()`)
- Basic field types

**Queries:**
- `findMany()`, `findFirst()`
- `with` (relation loading)
- `where` (filtering)
- `limit`, `offset`
- All filter operators (`eq`, `ne`, `gt`, `lt`, `gte`, `lte`, `and`, `or`, `not`)

**Mutations:**
- `insert().values()`
- `update().set().where()`
- `delete().where()`

### Category 2: ‚ö†Ô∏è Limited/Workaround

These features require alternative approaches:

| Feature | Drizzle | Better-Convex Workaround |
|---------|---------|--------------------------|
| Column selection | `.select({ name: true })` | Map after fetch: `.map(u => ({ name: u.name }))` |
| LIKE operator | `like(field, '%pattern%')` | Use Convex search indexes or post-filter |
| ILIKE operator | `ilike(field, '%pattern%')` | Use Convex search indexes (case-insensitive) |
| IN operator | `inArray(field, [1,2,3])` | Use `or(eq(...), eq(...), eq(...))` |
| Subqueries | Supported | ‚ùå Not supported (denormalize data) |
| Default values | `.default(false)` | Set in application code |
| Unique constraints | `.unique()` | Use Convex Ents `defineEnt` |

**Example: Column Selection Workaround**

```ts
// ‚ùå Drizzle pattern (not supported)
const users = await db.query.users.findMany({
  columns: { name: true, email: true },
});

// ‚úÖ Better-Convex workaround
const users = await db(ctx).query.users.findMany();
const nameAndEmail = users.map(u => ({
  name: u.name,
  email: u.email,
}));
```

**Example: LIKE Operator Workaround**

```ts
// ‚ùå Drizzle pattern (not supported)
const users = await db.query.users.findMany({
  where: like(users.name, '%alice%'),
});

// ‚úÖ Better-Convex workaround (post-filter)
const users = await db(ctx).query.users.findMany();
const filtered = users.filter(u =>
  u.name.toLowerCase().includes('alice')
);

// ‚úÖ Better approach (use Convex search index)
// Define in schema:
const users = defineEnt({ name: v.string() })
  .searchIndex('search_name', { searchField: 'name' });

// Query:
const users = await ctx.table('users')
  .search('search_name', q => q.search('name', 'alice'));
```

### Category 3: üöÄ Convex-Native Advantages

Features Better-Convex has that Drizzle doesn't:

**Real-Time Subscriptions**
```tsx
// Drizzle: No real-time - requires polling or WebSockets
const users = await db.query.users.findMany();

// Better-Convex: Real-time by default!
const users = useQuery(api.queries.getUsers); // Auto-updates
```

**Edge-Based Relations**
```ts
// Drizzle: SQL JOINs (can be slow)
// Better-Convex: Indexed edge traversal (faster)
```

**Cursor Pagination**
```ts
// Drizzle: Offset pagination only (slow for deep pages)
// Better-Convex: Cursor pagination (O(log n) performance)
```

**Automatic Indexes**
```ts
// Drizzle: Manual index creation
// Better-Convex: Auto-creates indexes for relations
```

### Category 4: ‚ùå Not Applicable

SQL-specific features not needed in Convex:

- **Raw SQL Queries**: Convex uses documents, not SQL
- **Connection Pooling**: Serverless handles this automatically
- **Database Migrations**: Convex is schemaless - no migrations needed
- **Transaction Isolation Levels**: Convex mutations are always serializable

## Migration Gotchas

| Gotcha | Solution |
|--------|----------|
| **`db` vs `db(ctx)`** | Always pass `ctx` to `db()` in Convex |
| **`id` vs `_id`** | Convex uses `_id`, Drizzle uses `id` |
| **`null` vs `undefined`** | Convex uses `undefined` for missing fields |
| **Column selection not working** | Remove `.select()` and map after fetch |
| **`like()` operator fails** | Use Convex search or post-filter |
| **Default values not applied** | Set defaults in application code |
| **Relations not loading** | Ensure relations exported in schema |
| **Type errors on `db(ctx)`** | Import `db` from `better-convex/orm` |

## Performance Comparison

| Operation | Drizzle (PostgreSQL) | Better-Convex | Winner |
|-----------|----------------------|---------------|--------|
| Simple query | ~10ms | ~5ms | üöÄ Better-Convex |
| Query with relations | ~50ms (JOINs) | ~15ms (edges) | üöÄ Better-Convex |
| Real-time updates | Manual polling | Automatic | üöÄ Better-Convex |
| Deep pagination | O(n+offset) | O(log n) | üöÄ Better-Convex |
| Column selection | ‚úÖ Supported | ‚ö†Ô∏è Post-filter | Drizzle |
| Full-text search | ‚úÖ Built-in | ‚úÖ Search indexes | Tie |

<Callout icon={<CheckCircle />}>
**Performance**: Better-Convex is typically 2-3x faster for relational queries due to edge-based relations instead of SQL JOINs.
</Callout>

## Step-by-Step Migration Example

### Before (Drizzle)

```ts title="db/schema.ts"
import { pgTable, serial, text } from 'drizzle-orm/pg-core';
import { relations } from 'drizzle-orm';

const users = pgTable('users', {
  id: serial('id').primaryKey(),
  name: text('name').notNull(),
  email: text('email').notNull(),
});

const posts = pgTable('posts', {
  id: serial('id').primaryKey(),
  title: text('title').notNull(),
  userId: integer('user_id').references(() => users.id),
});

const usersRelations = relations(users, ({ many }) => ({
  posts: many(posts),
}));
```

```ts title="app/queries.ts"
import { db } from './db';
import { users, posts } from './db/schema';
import { eq } from 'drizzle-orm';

export async function getUser(email: string) {
  return await db.query.users.findFirst({
    where: eq(users.email, email),
  });
}

export async function getPublishedPosts() {
  return await db.query.posts.findMany({
    where: eq(posts.published, true),
    limit: 10,
  });
}
```

### After (Better-Convex)

```ts title="convex/schema.ts"
import { convexTable, relations } from 'better-convex/orm';
import { v } from 'convex/values';

const users = convexTable('users', {
  // _id auto-created
  name: text().notNull(),
  email: text().notNull(),
});

const posts = convexTable('posts', {
  // _id auto-created
  title: text().notNull(),
  // userId created by relation
});

const usersRelations = relations(users, ({ many }) => ({
  posts: many(posts),
}));

const postsRelations = relations(posts, ({ one }) => ({
  author: one(users, {
    fields: [posts.userId],
    references: [users._id], // Changed: _id instead of id
  }),
}));

export const schema = {
  users,
  posts,
  usersRelations,
  postsRelations,
};
```

```ts title="convex/queries.ts"
import { query } from './_generated/server';
import { db } from 'better-convex/orm';
import { eq } from 'better-convex/orm';
import { v } from 'convex/values';

export const getUser = query({
  args: { email: v.string() },
  handler: async (ctx, args) => {
    return await db(ctx).query.users.findFirst({ // Changed: db(ctx) instead of db
      where: eq(users.email, args.email),
    });
  },
});

export const getPublishedPosts = query({
  handler: async (ctx) => {
    return await db(ctx).query.posts.findMany({
      where: eq(posts.published, true),
      limit: 10,
    });
  },
});
```

**Changes Made:**
1. Changed imports from `drizzle-orm` to `better-convex/orm`
2. Changed `pgTable` to `convexTable` with `v.*` validators
3. Removed manual `id` fields (auto-created as `_id`)
4. Added `ctx` parameter to `db(ctx)`
5. Wrapped queries in Convex `query` functions
4. Added `ctx` parameter to `db(ctx)`
5. Changed `users.id` to `users._id` in relations

## Next Steps

<Cards>
  <Card title="Schema Definition" href="/docs/db/orm/schema">
    Deep dive into table and relation patterns
  </Card>
  <Card title="Querying Data" href="/docs/db/orm/queries">
    Master all query operations
  </Card>
  <Card title="Real-Time" href="/docs/db/orm/real-time">
    Leverage Convex's real-time subscriptions
  </Card>
  <Card title="Limitations" href="/docs/db/orm/limitations">
    Full list of differences and workarounds
  </Card>
</Cards>

<Callout icon={<InfoIcon />}>
**Need Help?** Join the [Convex Discord](https://convex.dev/community) for migration support. Most Drizzle apps migrate in under 1 hour.
</Callout>

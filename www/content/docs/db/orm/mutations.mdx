---
title: Mutations (ðŸš§ WIP)
description: Insert, update, delete operations - Coming Soon in M5-M6
links:
  doc: https://orm.drizzle.team/docs/insert
---

import { InfoIcon, CheckCircle, AlertTriangle } from "lucide-react"

<Callout icon={<AlertTriangle />}>
**ðŸš§ Work in Progress**: Mutation operations (`insert`, `update`, `delete`) are planned and are not yet implemented. This documentation shows the **planned API design** that will mirror Drizzle ORM.

For now, use [Convex's native mutation methods](https://docs.convex.dev/database/writing-data) directly.
</Callout>

Mutation APIs in Better-Convex ORM will mirror Drizzle's insert, update, and delete operations with full type safety.

## Current Approach (Native Convex)

```ts title="convex/mutations.ts" showLineNumbers
import { mutation } from './_generated/server';
import { v } from 'convex/values';

export const createUser = mutation({
  args: { name: v.string(), email: v.string() },
  handler: async (ctx, args) => {
    const userId = await ctx.db.insert('users', {
      name: args.name,
      email: args.email,
    });

    return userId;
  },
});
```

## Planned API (M5-M6)

The following examples show the **planned API**. These features are **not yet implemented**.

### Insert (Planned)

```ts title="convex/mutations.ts" showLineNumbers
import { mutation } from './_generated/server';
import { v } from 'convex/values';
import { createDatabase } from 'better-convex/orm';
import { ormSchema, ormEdges } from './schema';

export const createUser = mutation({
  args: { name: v.string(), email: v.string() },
  handler: async (ctx, args) => {
    const db = createDatabase(ctx.db, ormSchema, ormEdges);
    const userId = await db.insert.users.values({
      name: args.name,
      email: args.email,
    });

    return userId;
  },
});
```

### Update (Planned)

```ts title="convex/mutations.ts" showLineNumbers
import { mutation } from './_generated/server';
import { v } from 'convex/values';
import { createDatabase } from 'better-convex/orm';
import { ormSchema, ormEdges } from './schema';

export const updateUserName = mutation({
  args: { userId: v.id('users'), newName: v.string() },
  handler: async (ctx, args) => {
    const db = createDatabase(ctx.db, ormSchema, ormEdges);
    await db.update.users
      .set({ name: args.newName })
      .where((users, { eq }) => eq(users._id, args.userId));
  },
});
```

### Delete (Planned)

```ts title="convex/mutations.ts" showLineNumbers
import { mutation } from './_generated/server';
import { v } from 'convex/values';
import { createDatabase } from 'better-convex/orm';
import { ormSchema, ormEdges } from './schema';

export const deleteUser = mutation({
  args: { userId: v.id('users') },
  handler: async (ctx, args) => {
    const db = createDatabase(ctx.db, ormSchema, ormEdges);
    await db.delete.users
      .where((users, { eq }) => eq(users._id, args.userId));
  },
});
```

<Callout icon={<InfoIcon />}>
**Atomicity**: Convex mutations are automatically atomic - no need for explicit transactions. All changes succeed or fail together.
</Callout>

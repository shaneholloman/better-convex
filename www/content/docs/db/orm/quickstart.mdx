---
title: Quickstart - Better-Convex ORM
description: Get started with Better-Convex ORM in 5 minutes
---

import { InfoIcon } from "lucide-react"

In this guide, we'll add the ORM to an existing Better-Convex project. You'll define tables and relations, attach the ORM to your context, and run your first type-safe query.

<Callout icon={<InfoIcon />}>
This quickstart shows both vanilla Convex procedures and better-convex cRPC. Other ORM docs use cRPC examples.
</Callout>

## Step 1: Define Tables

Next, we'll create `users` and `posts` tables using `convexTable`. Each field uses a Drizzle-style column builder:

```ts title="convex/schema.ts" showLineNumbers {3-7,10-14}
import { convexTable, text, boolean, integer, id, index } from 'better-convex/orm';

export const users = convexTable('users', {
  name: text().notNull(),
  email: text().notNull(),
  role: text(),
  age: integer(),
});

export const posts = convexTable('posts', {
  title: text().notNull(),
  content: text().notNull(),
  published: boolean(),
  userId: id('users'),
}, (t) => [index('by_published').on(t.published)]);
```

<Callout icon={<InfoIcon />}>
**Note:** Fields are nullable by default -- `text()` is `string | null`. Use `.notNull()` for required fields.
</Callout>

## Step 2: Define Relations

Now let's wire up the relationships between tables. We'll add a one-to-many relation from `users` to `posts`:

```ts title="convex/schema.ts" showLineNumbers {3-8}
import { defineRelations } from 'better-convex/orm';

export const relations = defineRelations({ users, posts }, (r) => ({
  users: { posts: r.many.posts() },
  posts: {
    author: r.one.users({ from: r.posts.userId, to: r.users._id }),
  },
}));
```

## Step 3: Attach ORM to Context (once)

Create a small helper that attaches Better-Convex ORM to `ctx.orm`. You only need to do this once in your context setup:

```ts title="convex/lib/orm.ts" showLineNumbers {5-8}
import type { GenericDatabaseWriter } from 'convex/server';
import { createOrm } from 'better-convex/orm';
import { relations } from '../schema';

const orm = createOrm({ schema: relations });

export const withOrm = <Ctx extends { db: GenericDatabaseWriter<any> }>(ctx: Ctx) => {
  return { ...ctx, orm: orm.db(ctx) };
};
```

If you use better-convex cRPC, you can wire it into the context like this:

```ts title="convex/lib/crpc.ts" showLineNumbers {3-4}
const c = initCRPC
  .dataModel<DataModel>()
  .context({
    query: (ctx) => withOrm(ctx),
    mutation: (ctx) => withOrm(ctx),
  })
  .create({ ... });
```

## Step 4: Query Data

You're ready to query. Here's how to fetch published posts with their authors using `ctx.orm`:

<Tabs groupId="orm-procedure-style" items={["Convex", "cRPC"]} persist>
  <Tab value="Convex">
    ```ts title="convex/functions/posts.ts" showLineNumbers {5-10}
    import { query } from './_generated/server';

    export const getPublishedPosts = query({
      handler: async (ctx) => {
        const db = ctx.orm;

        return db.query.posts.findMany({
          where: { published: true },
          orderBy: { _creationTime: 'desc' },
          limit: 10,
          with: { author: true },
        });
      },
    });
    ```
  </Tab>
  <Tab value="cRPC">
    ```ts title="convex/functions/posts.ts" showLineNumbers {4-9}
    import { publicQuery } from '../lib/crpc';

    export const getPublishedPosts = publicQuery.query(async ({ ctx }) => {
      const db = ctx.orm;

      return db.query.posts.findMany({
        where: { published: true },
        orderBy: { _creationTime: 'desc' },
        limit: 10,
        with: { author: true },
      });
    });
    ```
  </Tab>
</Tabs>

## What You Learned

You've now completed the full setup: defined tables with `convexTable()`, added relations with `defineRelations()`, attached the ORM once as `ctx.orm`, and queried data using Drizzle-style `findMany()`. From here, you can explore advanced querying, mutations, and row-level security.

## Common Gotchas

Here's a quick reference for issues you might hit during setup:

| Issue | Fix |
|---|---|
| `ctx.orm` is missing | Ensure `withOrm(ctx)` is applied in your context |
| Relations not loading | Ensure `defineRelations()` includes both sides (or explicit `from`/`to`) |
| Slow `orderBy` | Add `index('...').on(t.field)` in `convexTable` extraConfig |
| `columns` doesn't reduce reads | Projection is post-fetch |

## Next Steps

<Cards>
  <Card title="Schema Definition" href="/docs/db/orm/schema">
    Tables, relations, and indexes
  </Card>
  <Card title="Querying Data" href="/docs/db/orm/queries">
    Filters, ordering, pagination
  </Card>
  <Card title="Mutations" href="/docs/db/orm/mutations">
    Insert, update, delete
  </Card>
  <Card title="Drizzle Comparison" href="/docs/db/orm/comparison">
    Side-by-side API mapping
  </Card>
</Cards>
